<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<!-- generated by https://github.com/cabo/kramdown-rfc version 1.7.7 (Ruby 2.6.10) -->
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" ipr="trust200902" docName="draft-ietf-lamps-im-keyusage-00" category="info" consensus="true" submissionType="IETF" tocInclude="true" sortRefs="true" symRefs="true" version="3">
  <!-- xml2rfc v2v3 conversion 3.20.0 -->
  <front>
    <title abbrev="extendedKeyUsage for IM URIs">X.509 Certificate Extended Key Usage (EKU) for Instant Messaging URIs</title>
    <seriesInfo name="Internet-Draft" value="draft-ietf-lamps-im-keyusage-00"/>
    <author fullname="Rohan Mahy">
      <organization>Unaffiliated</organization>
      <address>
        <email>rohan.ietf@gmail.com</email>
      </address>
    </author>
    <date year="2024" month="April" day="15"/>
    <area>SEC</area>
    <workgroup>LAMPS WG</workgroup>
    <keyword>x.509</keyword>
    <keyword>certificate</keyword>
    <keyword>extended key usage</keyword>
    <keyword>eku</keyword>
    <keyword>instant messaging</keyword>
    <keyword>im URI</keyword>
    <keyword>mimi URL</keyword>
    <abstract>
      <?line 61?>

<t>RFC 5280 specifies several extended key purpose identifiers
(KeyPurposeIds) for X.509 certificates.  This document defines
Instant Messaging (IM) identity KeyPurposeId for inclusion in
the Extended Key Usage (EKU) extension of X.509 v3 public key
certificates</t>
    </abstract>
    <note removeInRFC="true">
      <name>About This Document</name>
      <t>
        The latest revision of this draft can be found at <eref target="https://rohanmahy.github.io/mahy-lamps-im-keyusage/draft-ietf-lamps-im-keyusage.html"/>.
        Status information for this document may be found at <eref target="https://datatracker.ietf.org/doc/draft-ietf-lamps-im-keyusage/"/>.
      </t>
      <t>
        Discussion of this document takes place on the
        LAMPS WG Working Group mailing list (<eref target="mailto:lamps@ietf.org"/>),
        which is archived at <eref target="https://mailarchive.ietf.org/arch/browse/lamps/"/>.
        Subscribe at <eref target="https://www.ietf.org/mailman/listinfo/lamps/"/>.
      </t>
      <t>Source for this draft and an issue tracker can be found at
        <eref target="https://github.com/rohanmahy/mahy-lamps-im-keyusage"/>.</t>
    </note>
  </front>
  <middle>
    <?line 70?>

<section anchor="introduction">
      <name>Introduction</name>
      <t>Instant Messaging (IM) systems using the Messaging Layer Security (MLS)
<xref target="RFC9420"/> protocol can incorporate per-client identity certificate
credentials. The subjectAltName of these certificates can be an IM URI, for
example. Since IM clients could be very numerous, operators are
reticent to issue certificates for these users that might accidentally be used
to validate a TLS connection because it has the KeyPurposeId <tt>id-kp-serverAuth</tt> or
<tt>id-kp-clientAuth</tt>.</t>
      <t>An explanation of MLS credentials as they apply to Instant Messaging is described
in <xref target="I-D.barnes-mimi-identity-arch"/>. These credentials are expected to be
heavily used in the More Instant Messaging Interoperability (MIMI) Working Group.</t>
    </section>
    <section anchor="conventions-and-definitions">
      <name>Conventions and Definitions</name>
      <t>The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
"<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>
      <?line -18?>

</section>
    <section anchor="the-im-uri-extended-key-usage">
      <name>The IM URI Extended Key Usage</name>
      <t>This specification defines the KeyPurposeId id-kp-imUri, which is used
for signing messages to prove the identity of an Instant Messaging client.
This Extended Key Usage is optionally critical.</t>
      <artwork><![CDATA[
id-kp  OBJECT IDENTIFIER  ::= {
  iso(1) identified-organization(3) dod(6) internet(1)
  security(5) mechanisms(5) pkix(7) kp(3) }

id-kp-imUri OBJECT IDENTIFIER ::= { id-kp TBD1 }
]]></artwork>
    </section>
    <section anchor="security-considerations">
      <name>Security Considerations</name>
      <t>The Security Considerations of <xref target="RFC5280"/> are applicable to this
document.  This extended key purpose does not introduce new security
risks but instead reduces existing security risks by providing means
to identify if the certificate is generated to sign IM identity credentials.</t>
    </section>
    <section anchor="iana-considerations">
      <name>IANA Considerations</name>
      <t>IANA is requested to register the following OIDs in the "SMI Security
for PKIX Extended Key Purpose" registry (1.3.6.1.5.5.7.3).  These
OIDs are defined in Section 4.</t>
      <table>
        <thead>
          <tr>
            <th align="left">Decimal</th>
            <th align="left">Description</th>
            <th align="left">References</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">TBD1</td>
            <td align="left">id-kp-imUri</td>
            <td align="left">This-RFC</td>
          </tr>
        </tbody>
      </table>
      <t>IANA is also requested to register the following ASN.1 <xref target="ITU.X690.2021"/>
module OID in the "SMI Security for PKIX Module Identifier" registry (1.3.6.1.5.5.7.0). This OID is defined in <xref target="asn1-module"/>.</t>
      <table>
        <thead>
          <tr>
            <th align="left">Decimal</th>
            <th align="left">Description</th>
            <th align="left">References</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">TBD2</td>
            <td align="left">id-kp-im-eku</td>
            <td align="left">This-RFC</td>
          </tr>
        </tbody>
      </table>
    </section>
  </middle>
  <back>
    <references>
      <name>References</name>
      <references anchor="sec-normative-references">
        <name>Normative References</name>
        <reference anchor="ITU.X690.2021">
          <front>
            <title>Information Technology — ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)</title>
            <author>
              <organization>International Telecommunications Union</organization>
            </author>
            <date year="2021"/>
          </front>
          <seriesInfo name="ITU-T" value="Recommendation X.690"/>
        </reference>
        <reference anchor="ITU.X680.2021">
          <front>
            <title>Information Technology — Abstract Syntax Notation One (ASN.1): Specification of basic notation</title>
            <author>
              <organization>International Telecommunications Union</organization>
            </author>
            <date year="2021"/>
          </front>
          <seriesInfo name="ITU-T" value="Recommendation X.680"/>
        </reference>
        <reference anchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author fullname="S. Bradner" initials="S." surname="Bradner"/>
            <date month="March" year="1997"/>
            <abstract>
              <t>In many standards track documents several words are used to signify the requirements in the specification. These words are often capitalized. This document defines these words as they should be interpreted in IETF documents. This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author fullname="B. Leiba" initials="B." surname="Leiba"/>
            <date month="May" year="2017"/>
            <abstract>
              <t>RFC 2119 specifies common key words that may be used in protocol specifications. This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC5280">
          <front>
            <title>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</title>
            <author fullname="D. Cooper" initials="D." surname="Cooper"/>
            <author fullname="S. Santesson" initials="S." surname="Santesson"/>
            <author fullname="S. Farrell" initials="S." surname="Farrell"/>
            <author fullname="S. Boeyen" initials="S." surname="Boeyen"/>
            <author fullname="R. Housley" initials="R." surname="Housley"/>
            <author fullname="W. Polk" initials="W." surname="Polk"/>
            <date month="May" year="2008"/>
            <abstract>
              <t>This memo profiles the X.509 v3 certificate and X.509 v2 certificate revocation list (CRL) for use in the Internet. An overview of this approach and model is provided as an introduction. The X.509 v3 certificate format is described in detail, with additional information regarding the format and semantics of Internet name forms. Standard certificate extensions are described and two Internet-specific extensions are defined. A set of required certificate extensions is specified. The X.509 v2 CRL format is described in detail along with standard and Internet-specific extensions. An algorithm for X.509 certification path validation is described. An ASN.1 module and examples are provided in the appendices. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5280"/>
          <seriesInfo name="DOI" value="10.17487/RFC5280"/>
        </reference>
      </references>
      <references anchor="sec-informative-references">
        <name>Informative References</name>
        <reference anchor="RFC9420">
          <front>
            <title>The Messaging Layer Security (MLS) Protocol</title>
            <author fullname="R. Barnes" initials="R." surname="Barnes"/>
            <author fullname="B. Beurdouche" initials="B." surname="Beurdouche"/>
            <author fullname="R. Robert" initials="R." surname="Robert"/>
            <author fullname="J. Millican" initials="J." surname="Millican"/>
            <author fullname="E. Omara" initials="E." surname="Omara"/>
            <author fullname="K. Cohn-Gordon" initials="K." surname="Cohn-Gordon"/>
            <date month="July" year="2023"/>
            <abstract>
              <t>Messaging applications are increasingly making use of end-to-end security mechanisms to ensure that messages are only accessible to the communicating endpoints, and not to any servers involved in delivering messages. Establishing keys to provide such protections is challenging for group chat settings, in which more than two clients need to agree on a key but may not be online at the same time. In this document, we specify a key establishment protocol that provides efficient asynchronous group key establishment with forward secrecy (FS) and post-compromise security (PCS) for groups in size ranging from two to thousands.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9420"/>
          <seriesInfo name="DOI" value="10.17487/RFC9420"/>
        </reference>
        <reference anchor="I-D.barnes-mimi-identity-arch">
          <front>
            <title>Identity for E2E-Secure Communications</title>
            <author fullname="Richard Barnes" initials="R." surname="Barnes">
              <organization>Cisco</organization>
            </author>
            <author fullname="Rohan Mahy" initials="R." surname="Mahy">
              <organization>Wire</organization>
            </author>
            <date day="23" month="October" year="2023"/>
            <abstract>
              <t>   End-to-end (E2E) security is a critical property for modern user
   communications systems.  E2E security protects users' communications
   from tampering or inspection by intermediaries that are involved in
   delivering those communcations from one logical endpoint to another.
   In addition to the much-discussed E2E encryption systems, true E2E
   security requires an identity mechanism that prevents the
   communications provider from impersonating participants in a session,
   as a way to gain access to the session.  This document describes a
   high-level architecture for E2E identity, identifying the critical
   mechanisms that need to be specified.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-barnes-mimi-identity-arch-01"/>
        </reference>
      </references>
    </references>
    <?line 149?>

<section anchor="asn1-module">
      <name>ASN.1 Module</name>
      <t>The following module adheres to ASN.1 specifications <xref target="ITU.X680.2021"/> and
<xref target="ITU.X690.2021"/>.</t>
      <sourcecode type="asn1"><![CDATA[
<CODE BEGINS>

IM-EKU
  { iso(1) identified-organization(3) dod(6) internet(1)
  security(5) mechanisms(5) pkix(7) id-mod(0)
  id-mod-im-eku (TBD2) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

-- OID Arc

id-kp OBJECT IDENTIFIER ::=
  { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) kp(3) }

-- Extended Key Usage Values

id-kp-imUri OBJECT IDENTIFIER ::= { id-kp TBD1 }

END


<CODE ENDS>
]]></sourcecode>
    </section>
    <section anchor="change-log">
      <name>Change log</name>
      <ul spacing="normal">
        <li>
          <t>added ASN.1 module</t>
        </li>
        <li>
          <t>specified that eku is optionally critical</t>
        </li>
      </ul>
    </section>
  </back>
  <!-- ##markdown-source:
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
AAA=

-->

</rfc>
